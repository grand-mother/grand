<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>src_outlib.AiresInfoFunctionsGRANDROOT &mdash; grandlib 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=d45e8c67"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            grandlib
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"></div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">grandlib</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">src_outlib.AiresInfoFunctionsGRANDROOT</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for src_outlib.AiresInfoFunctionsGRANDROOT</h1><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## WARNING WARNING WARNING</span>
<span class="c1">##</span>
<span class="c1"># this file is a local copy of AiresInfoFunctions from https://github.com/mjtueros/ZHAireS-Python  (on Jun 25 2021)so that</span>
<span class="c1"># you dont have to setup that repository, that requires ZHAireS to be installed. (since we dont use it for now). Will update it manually if needed</span>
<span class="c1"># table exporting will not be available!!</span>
<span class="c1">##</span>
<span class="c1">## WARNING WARNING WARNING</span>
<span class="c1">##</span>


<span class="c1"># if you are having encoding errors, specially in lyon, be sure to force the environment to utf8</span>
<span class="c1"># setenv  LANGUAGE en_US.UTF-8 ;setenv  LC_ALL en_US.UTF-8 ;setenv  LANG en_US.UTF-8setenv LC_TYPE en_US.UTF-8</span>
<span class="c1">#</span>

<span class="c1"># this functions will accept GRAND and AIRES outmode, to give the results in each convention</span>
<span class="c1"># it will output the primary zen,azim,energy,primarytype, taken from the .inp file present at input_file_path) (assumed only one .inp file per dir)</span>


<span class="c1"># TO DO: treat correctly the different possible primary types, including RASPASS Multi primary</span>
<span class="c1"># TO DO: treat correctly the case where a distribution of primary types or energies or angles is put in the input</span>
<span class="c1"># TO DO: Check consistency of the output (energy within a range, angles within a range, etc)</span>
<span class="c1"># TO DO: have the .sry reader regenerate the summary using AiresSry, if the file is not foun</span>

<span class="c1"># 6/2019 Matias Tueros, first attempt at python based on original script by Anne Zilles.</span>
<span class="c1"># 10/2019 Migrated them to make it the official library</span>
<span class="c1"># 12/2019 Set up on git</span>
<span class="c1"># 03/2020 Corona Virus</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">argv</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="c1"># this function reads he Aires .sry file and tries to extract information from the simulation parameters</span>
<span class="c1"># using the .sry file is preferred to using the .inp files because:</span>
<span class="c1"># Output is standarized: you dont know what you can find in an .inp file (leading spaces, commented lines, repeated keywords, etc)</span>
<span class="c1"># Output is what really happened, not what the user whished it would happen when he did his crappy .inp file.</span>

<span class="c1"># lets break the ReadAiresSry into smaller modules. It has the disadventage of opening, scanning and closing the file each time</span>
<span class="c1"># but it adds modularity, and closes the files when it does not use it any more.</span>
<span class="c1"># If at some point we need speed, then we could input datafile, and make a wraper for opening the file</span>

<span class="c1"># AiresPath=&quot;/home/mjtueros/aires/bin&quot;</span>
<span class="c1"># AiresPath=os.environ[&quot;AIRESBINDIR&quot;]</span>
<span class="c1"># AiresPath=&quot;/home/mjtueros/AiresRepository/Dropbox/AiresBzr/Aires.19-04-04-ZHAireS-development/zhadl/bin&quot;</span>


<div class="viewcode-block" id="GetZenithAngleFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetZenithAngleFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetZenithAngleFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;GRAND&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Primary zenith angle:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">zen</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">outmode</span> <span class="o">==</span> <span class="s2">&quot;GRAND&quot;</span><span class="p">:</span>
                        <span class="n">zen</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="mi">180</span> <span class="o">-</span> <span class="n">zen</span>
                        <span class="p">)</span>  <span class="c1"># conversion to GRAND convention i.e. pointing towards antenna/propagtion direction</span>
                    <span class="c1"># logging.debug(&#39;Found Zenith &#39; + str(zen))</span>
                    <span class="k">return</span> <span class="n">zen</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">zen</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">zen</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># If no zenith angle was included in the input file, AIRES defaults to 0</span>
                <span class="k">if</span> <span class="n">outmode</span> <span class="o">==</span> <span class="s2">&quot;GRAND&quot;</span><span class="p">:</span>
                    <span class="n">zen</span> <span class="o">=</span> <span class="mi">180</span> <span class="o">-</span> <span class="mi">0</span>  <span class="c1"># that translates to 180 in GRAND</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Zenith Angle not found in sry file, defaulting to:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">zen</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">zen</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetZenithAngleFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetAzimuthAngleFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetAzimuthAngleFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetAzimuthAngleFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;GRAND&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Primary azimuth angle:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">azim</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">outmode</span> <span class="o">==</span> <span class="s2">&quot;GRAND&quot;</span><span class="p">:</span>
                        <span class="n">azim</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="n">azim</span> <span class="o">+</span> <span class="mi">180</span>
                        <span class="p">)</span>  <span class="c1"># conversion to GRAND convention i.e. pointing towards antenna/propagtion direction</span>
                        <span class="k">if</span> <span class="n">azim</span> <span class="o">&gt;=</span> <span class="mi">360</span><span class="p">:</span>
                            <span class="n">azim</span> <span class="o">=</span> <span class="n">azim</span> <span class="o">-</span> <span class="mi">360</span>
                    <span class="c1"># logging.debug(&#39;Found Azimuth &#39; + str(azim))</span>
                    <span class="k">return</span> <span class="n">azim</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">azim</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">azim</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># If no azimuth angle was included in the input file, AIRES defaults to 0</span>
                <span class="k">if</span> <span class="n">outmode</span> <span class="o">==</span> <span class="s2">&quot;GRAND&quot;</span><span class="p">:</span>
                    <span class="n">azim</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">+</span> <span class="mi">180</span>  <span class="c1"># that translates to 18</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Azimuth Angle not found in sry file, defaulting to:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">azim</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">azim</span>

    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetAzimuthAngleFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetEnergyFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetEnergyFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetEnergyFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;GRAND&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Primary energy:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">try</span><span class="p">:</span>  <span class="c1"># this is to detect if it is the first time we find the string, so that we ignore the following</span>
                        <span class="n">energy</span>
                    <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">])</span>
                        <span class="n">unit</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;eV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                            <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-9</span>
                        <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;KeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                            <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-6</span>
                        <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;MeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                            <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-3</span>
                        <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;GeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                            <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span>
                        <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;TeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                            <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e3</span>
                        <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;PeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                            <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e6</span>
                        <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;EeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                            <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e9</span>

                        <span class="k">if</span> <span class="n">outmode</span> <span class="o">==</span> <span class="s2">&quot;GRAND&quot;</span><span class="p">:</span>  <span class="c1"># AIRES mode outputs in GeV, GRAND in EeV</span>
                            <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-9</span>
                        <span class="c1"># logging.debug(&#39;Found Energy &#39; + str(energy)) #debug level 1</span>
                        <span class="k">return</span> <span class="n">energy</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">energy</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="s2">&quot;warning energy not found, Aires has no default value,  cannot continue&quot;</span>
                <span class="p">)</span>
                <span class="n">exit</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetEnergyFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<span class="c1"># output is in meters</span>
<div class="viewcode-block" id="GetCorePositionFromInp">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetCorePositionFromInp">[docs]</a>
<span class="k">def</span> <span class="nf">GetCorePositionFromInp</span><span class="p">(</span><span class="n">inp_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">inp_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">inp_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;#Core Position:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="n">z</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                    <span class="n">coreposition</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">coreposition</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">coreposition</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning core position not found, defaulting to (0,0,0)&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetCorePositionFromInp:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">inp_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetThinningRelativeEnergyFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetThinningRelativeEnergyFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetThinningRelativeEnergyFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Thinning energy:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;Thinning energy:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">Thinning</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">Relative</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">Relative</span> <span class="o">!=</span> <span class="s2">&quot;Relative</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                            <span class="s2">&quot;warning , we only support Relative thinning for now, sorry!. This is easy to implement if you need it!&quot;</span>
                        <span class="p">)</span>
                        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="k">return</span> <span class="n">Thinning</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">Thinning</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="s2">&quot;warning Thinning energy not found, Aires has no default value, cannot continue&quot;</span>
                <span class="p">)</span>
                <span class="n">exit</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetThinningRelativeEnergyFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetGammaEnergyCutFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetGammaEnergyCutFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetGammaEnergyCutFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Cut energy for gammas:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;Cut energy for gammas:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">energy</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">unit</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;eV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-6</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;KeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-3</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;MeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;GeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e3</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;TeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e6</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;PeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e9</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;EeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e12</span>
                    <span class="k">return</span> <span class="n">energy</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">energy</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning GammaCutEnergy not found, defaulting to 80keV&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="mi">80</span> <span class="o">+</span> <span class="mf">1e-3</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetGammaEnergyCutFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetElectronEnergyCutFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetElectronEnergyCutFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetElectronEnergyCutFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Cut energy for e+ e-:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;Cut energy for e+ e-:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">energy</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">unit</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;eV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-6</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;KeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-3</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;MeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;GeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e3</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;TeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e6</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;PeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e9</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;EeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e12</span>
                    <span class="k">return</span> <span class="n">energy</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">energy</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning ElectronCutEnergy not found, defaulting to 80keV&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="mi">80</span> <span class="o">+</span> <span class="mf">1e-3</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetElectronEnergyCutFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetMuonEnergyCutFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetMuonEnergyCutFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetMuonEnergyCutFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Cut energy for mu+ mu-:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;Cut energy for mu+ mu-:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">energy</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">unit</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;eV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-6</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;KeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-3</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;MeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;GeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e3</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;TeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e6</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;PeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e9</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;EeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e12</span>
                    <span class="k">return</span> <span class="n">energy</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">energy</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning MuonCutEnergy not found, defaulting to 10MeV&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="mi">10</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetMuonEnergyCutFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetMesonEnergyCutFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetMesonEnergyCutFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetMesonEnergyCutFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Cut energy for mesons:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;Cut energy for mesons:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">energy</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">unit</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;eV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-6</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;KeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-3</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;MeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;GeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e3</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;TeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e6</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;PeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e9</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;EeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e12</span>
                    <span class="k">return</span> <span class="n">energy</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">energy</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning MesonCutEnergy not found, defaulting to 60MeV&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="mi">60</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetMesonEnergyCutFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetNucleonEnergyCutFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetNucleonEnergyCutFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetNucleonEnergyCutFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Cut energy for nucleons:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;Cut energy for nucleons:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">energy</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">unit</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;eV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-6</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;KeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-3</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;MeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;GeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e3</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;TeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e6</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;PeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e9</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;EeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e12</span>
                    <span class="k">return</span> <span class="n">energy</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">energy</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning NucleonCutEnergy not found, defaulting to 60MeV&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="mi">60</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetNucleonEnergyCutFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetPrimaryFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetPrimaryFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetPrimaryFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Primary particle:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">primarytype</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                        <span class="n">primarytype</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
                        <span class="n">primarytype</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
                        <span class="n">primarytype</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">primarytype</span> <span class="o">=</span> <span class="s2">&quot;unknown&quot;</span>
                    <span class="n">primarytype</span> <span class="o">=</span> <span class="n">primarytype</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="c1"># logging.debug(&#39;Found Primary &#39; + primarytype) #debug level 1</span>

                    <span class="k">if</span> <span class="n">outmode</span> <span class="o">==</span> <span class="s2">&quot;GRAND&quot;</span><span class="p">:</span>
                        <span class="c1"># convert to GRAND coding. PDG?</span>
                        <span class="k">if</span> <span class="n">primarytype</span> <span class="o">==</span> <span class="s2">&quot;Proton&quot;</span><span class="p">:</span>
                            <span class="n">primarytype</span> <span class="o">=</span> <span class="mi">2212</span>
                        <span class="k">if</span> <span class="n">primarytype</span> <span class="o">==</span> <span class="s2">&quot;Neutron&quot;</span><span class="p">:</span>
                            <span class="n">primarytype</span> <span class="o">=</span> <span class="mi">2112</span>
                        <span class="k">if</span> <span class="n">primarytype</span> <span class="o">==</span> <span class="s2">&quot;Pi0&quot;</span><span class="p">:</span>
                            <span class="n">primarytype</span> <span class="o">=</span> <span class="mi">111</span>
                        <span class="k">if</span> <span class="n">primarytype</span> <span class="o">==</span> <span class="s2">&quot;Pi+&quot;</span><span class="p">:</span>
                            <span class="n">primarytype</span> <span class="o">=</span> <span class="mi">211</span>
                        <span class="k">if</span> <span class="n">primarytype</span> <span class="o">==</span> <span class="s2">&quot;Pi-&quot;</span><span class="p">:</span>
                            <span class="n">primarytype</span> <span class="o">=</span> <span class="o">-</span><span class="mi">211</span>

                    <span class="k">return</span> <span class="n">primarytype</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">primarytype</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="s2">&quot;warning primary not found, Aires has no default value, cannot continue&quot;</span>
                <span class="p">)</span>
                <span class="n">exit</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetPrimaryFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetSlantXmaxFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetSlantXmaxFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetSlantXmaxFromSry</span><span class="p">(</span>
    <span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span>
<span class="p">):</span>  <span class="c1"># To do. Handle when Xmax is not found, becouse the fit didnt converge</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Sl. depth of max. (g/cm2)&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">xmax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
                    <span class="c1"># logging.debug(&#39;Found Xmax &#39; + str(xmax)) #debug level 1</span>
                    <span class="k">return</span> <span class="n">xmax</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">xmax</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;warning xmax not found&quot;</span><span class="p">)</span>
                <span class="n">xmax</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">return</span> <span class="n">xmax</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetSlantXmaxFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<span class="c1">#</span>
<span class="c1"># Charged pcles. at maximum</span>
<div class="viewcode-block" id="GetNmaxFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetNmaxFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetNmaxFromSry</span><span class="p">(</span>
    <span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span>
<span class="p">):</span>  <span class="c1"># To do. Handle when Xmax is not found, becouse the fit didnt converge</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Charged pcles. at maximum&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">nmax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
                    <span class="c1"># logging.debug(&#39;Found Nmax &#39; + str(nmax)) #debug level 1</span>
                    <span class="k">return</span> <span class="n">nmax</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">xmax</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;warning nmax not found&quot;</span><span class="p">)</span>
                <span class="n">xmax</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">return</span> <span class="n">xmax</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetNmaxFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<span class="c1">#                              Altitude  Distance     x        y        z</span>
<span class="c1">#      Location of max.(Km):     3.612     3.66     0.00     0.57     3.61</span>
<div class="viewcode-block" id="GetKmXmaxFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetKmXmaxFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetKmXmaxFromSry</span><span class="p">(</span>
    <span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span>
<span class="p">):</span>  <span class="c1"># To do. Handle when Xmax is not found, becouse the fit didnt converge, or becouse this is not ZHAireS, or its latest version</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;Location of max.(Km)&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;Pos. Max.&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">):</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="n">kmxmax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span><span class="p">])</span>
                    <span class="n">distance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="p">])</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="p">])</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">])</span>
                    <span class="n">z</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                        <span class="s2">&quot;Found Xmax altitude &quot;</span>
                        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kmxmax</span><span class="p">)</span>
                        <span class="o">+</span> <span class="s2">&quot; distance &quot;</span>
                        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
                        <span class="o">+</span> <span class="s2">&quot; x:&quot;</span>
                        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                        <span class="o">+</span> <span class="s2">&quot; y:&quot;</span>
                        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
                        <span class="o">+</span> <span class="s2">&quot; z:&quot;</span>
                        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                    <span class="p">)</span>  <span class="c1"># debug level 1</span>
                    <span class="k">return</span> <span class="n">kmxmax</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">kmxmax</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;warning distance to xmax not found&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetKmXmaxFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetExpectedKmXmaxFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetExpectedKmXmaxFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetExpectedKmXmaxFromSry</span><span class="p">(</span>
    <span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span>
<span class="p">):</span>  <span class="c1"># To do. Handle when Xmax is not found, becouse the fit didnt converge, or becouse this is not ZHAireS, or its latest version</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Exp Distance To Xmax&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="n">kmxmax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">])</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Found Expected Xmax distance &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kmxmax</span><span class="p">))</span>  <span class="c1"># debug level 1</span>
                    <span class="k">return</span> <span class="n">kmxmax</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">kmxmax</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;warning expected distance to xmax not found&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetExpectedKmXmaxFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetTaskNameFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetTaskNameFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetTaskNameFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Task Name:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">taskname</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="n">taskname</span> <span class="o">=</span> <span class="n">taskname</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="c1"># logging.debug(&quot;Found taskname &quot; + taskname)</span>
                    <span class="k">if</span> <span class="s2">&quot;...&quot;</span> <span class="ow">in</span> <span class="n">taskname</span><span class="p">:</span>
                        <span class="n">base</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">sry_file</span><span class="p">)</span>
                        <span class="n">taskname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">base</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;taskname contained ... (too long), using filename instead&quot;</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;taskname:&quot;</span> <span class="o">+</span> <span class="n">taskname</span><span class="p">)</span>

                    <span class="k">return</span> <span class="n">taskname</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">taskname</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="s2">&quot;warning taskname not found, Aires has no default value, cannot continue&quot;</span>
                <span class="p">)</span>
                <span class="n">exit</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetTaskNameFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<span class="k">def</span> <span class="nf">GetRandomSeedFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Seed of random generator:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">randomseed</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="n">randomseed</span> <span class="o">=</span> <span class="n">randomseed</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">randomseed</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">randomseed</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="s2">&quot;warning randomseed not found, Aires has no default value, cannot continue&quot;</span>
                <span class="p">)</span>
                <span class="n">exit</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetRandomSeedFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>


<span class="c1"># output is in meters</span>
<div class="viewcode-block" id="GetGroundAltitudeFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetGroundAltitudeFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetGroundAltitudeFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Ground altitude:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">groundalt</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">unit</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;km&quot;</span><span class="p">:</span>
                        <span class="n">groundalt</span> <span class="o">=</span> <span class="n">groundalt</span> <span class="o">*</span> <span class="mf">1000.0</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;cm&quot;</span><span class="p">:</span>
                        <span class="n">groundalt</span> <span class="o">=</span> <span class="n">groundalt</span> <span class="o">/</span> <span class="mf">100.0</span>
                    <span class="k">return</span> <span class="n">groundalt</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">groundalt</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning groundalt not found, defaulting to sea level&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="mi">0</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetGroundAltitudeFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetTimeBinFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetTimeBinFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetTimeBinFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Time Domain Bin Size:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;Time Domain Bin Size:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">timebin</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">unit</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">!=</span> <span class="s2">&quot;sec</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                            <span class="s2">&quot;warning, time bin must be in seconds on the summary file, other units not supported yet&quot;</span>
                        <span class="p">)</span>
                        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="k">return</span> <span class="n">timebin</span> <span class="o">*</span> <span class="mf">1e9</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">timebin</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning timebin not found&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="mi">0</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetTimeBinFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetTimeWindowMinFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetTimeWindowMinFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetTimeWindowMinFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Antenna Time Window Min:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;Antenna Time Window Min:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">timemin</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">unit</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">!=</span> <span class="s2">&quot;sec</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                            <span class="s2">&quot;warning, time window must be in seconds on the summary file, other units not supported yet&quot;</span>
                        <span class="p">)</span>
                        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="k">return</span> <span class="n">timemin</span> <span class="o">*</span> <span class="mf">1e9</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">timemin</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning timewindow min not found&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="mi">0</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetTimeWindowMinFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetTimeWindowMaxFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetTimeWindowMaxFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetTimeWindowMaxFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Antenna Time Window Max:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;Antenna Time Window Max:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">timemax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">unit</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">!=</span> <span class="s2">&quot;sec</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                            <span class="s2">&quot;warning, time window must be in seconds on the summary file, other units not supported yet&quot;</span>
                        <span class="p">)</span>
                        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="k">return</span> <span class="n">timemax</span> <span class="o">*</span> <span class="mf">1e9</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">timemax</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning timewindow max not found&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="mi">0</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetTimeWindowMaxFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetWeightFactorFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetWeightFactorFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetWeightFactorFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Max. stat. weight factor:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">wf</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">return</span> <span class="n">wf</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">wf</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning weight factor not found, default is 12&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="mi">12</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetWeightFactorFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetMagneticFieldFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetMagneticFieldFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetMagneticFieldFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="n">fieldintensity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">fieldinclination</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">fielddeclination</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Geomagnetic field:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="k">if</span> <span class="s2">&quot;Off&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                        <span class="n">fieldintensity</span> <span class="o">=</span> <span class="mf">0.0</span>
                        <span class="n">fieldinclination</span> <span class="o">=</span> <span class="mf">0.0</span>
                        <span class="n">fielddeclination</span> <span class="o">=</span> <span class="mf">0.0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;Intensity:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                        <span class="n">intensityline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">intensityline</span> <span class="o">=</span> <span class="n">intensityline</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                        <span class="n">stripedline</span> <span class="o">=</span> <span class="n">intensityline</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                        <span class="n">fieldintensity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="s2">&quot;I:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;I:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">inclinationline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">inclinationline</span> <span class="o">=</span> <span class="n">inclinationline</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">inclinationline</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">fieldinclination</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;D:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">declinationline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">declinationline</span> <span class="o">=</span> <span class="n">declinationline</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">declinationline</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">fielddeclination</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">fieldintensity</span>
                <span class="k">return</span> <span class="n">fieldintensity</span><span class="p">,</span> <span class="n">fieldinclination</span><span class="p">,</span> <span class="n">fielddeclination</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning MagneticField not found, defaulting to sea level&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetMagneticFieldFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetTotalCPUTimeFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetTotalCPUTimeFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetTotalCPUTimeFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Total CPU time&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">CPUtime</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="c1"># logging.debug(&quot;Found taskname &quot; + taskname)</span>
                    <span class="n">CPUtime</span> <span class="o">=</span> <span class="n">CPUtime</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">CPUtime</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">time</span> <span class="o">=</span> <span class="mf">0.0</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">stripedline</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;sec&quot;</span><span class="p">:</span>
                            <span class="n">time</span> <span class="o">=</span> <span class="n">time</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">stripedline</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
                            <span class="n">time</span> <span class="o">=</span> <span class="n">time</span> <span class="o">+</span> <span class="mf">60.0</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">stripedline</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;hr&quot;</span><span class="p">:</span>
                            <span class="n">time</span> <span class="o">=</span> <span class="n">time</span> <span class="o">+</span> <span class="mf">60.0</span> <span class="o">*</span> <span class="mf">60.0</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">stripedline</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;sec&quot;</span><span class="p">:</span>
                            <span class="n">time</span> <span class="o">=</span> <span class="n">time</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">stripedline</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
                            <span class="n">time</span> <span class="o">=</span> <span class="n">time</span> <span class="o">+</span> <span class="mf">60.0</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">stripedline</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;hr&quot;</span><span class="p">:</span>
                            <span class="n">time</span> <span class="o">=</span> <span class="n">time</span> <span class="o">+</span> <span class="mf">60.0</span> <span class="o">*</span> <span class="mf">60.0</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">stripedline</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;sec&quot;</span><span class="p">:</span>
                            <span class="n">time</span> <span class="o">=</span> <span class="n">time</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">stripedline</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
                            <span class="n">time</span> <span class="o">=</span> <span class="n">time</span> <span class="o">+</span> <span class="mf">60.0</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">stripedline</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;hr&quot;</span><span class="p">:</span>
                            <span class="n">time</span> <span class="o">=</span> <span class="n">time</span> <span class="o">+</span> <span class="mf">60.0</span> <span class="o">*</span> <span class="mf">60.0</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">])</span>
                    <span class="n">CPUtime</span> <span class="o">=</span> <span class="n">time</span>
                    <span class="k">return</span> <span class="n">CPUtime</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">CPUtime</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning Total CPU time not found&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetTotalCPUTimeFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetHadronicModelFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetHadronicModelFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetHadronicModelFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Hadronic Mean Free Paths&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">HadronicModel</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="c1"># logging.debug(&quot;Found taskname &quot; + taskname)</span>
                    <span class="k">return</span> <span class="n">HadronicModel</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">HadronicModel</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning Hadronic Model not found&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetHadronicModelFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetRandomSeedFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetRandomSeedFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetRandomSeedFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Seed of random generator:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">RandomSeed</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="c1"># logging.debug(&quot;Found taskname &quot; + taskname)</span>
                    <span class="k">return</span> <span class="n">RandomSeed</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">RandomSeedl</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning RandomSeed not found&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetRandomSeedFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetAiresVersionFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetAiresVersionFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetAiresVersionFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;This is AIRES version&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;This is AIRES version&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">AiresVersion</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="c1"># ogging.debug(&quot;Found Version &quot; + AiresVersion)</span>
                    <span class="k">return</span> <span class="n">AiresVersion</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">AiresVersion</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning Aires Version not found&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetAiresVersionFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetZHAireSVersionFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetZHAireSVersionFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetZHAireSVersionFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;With ZHAireS version&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;With ZHAireS version&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">ZHAiresVersion</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="c1"># ogging.debug(&quot;Found Version &quot; + AiresVersion)</span>
                    <span class="k">return</span> <span class="n">ZHAiresVersion</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ZHAiresVersion</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning ZHAireS Version not found&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetZHAireSVersionFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetAtmosphericModelFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetAtmosphericModelFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetAtmosphericModelFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Atmospheric model&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">AtmosphericModel</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="c1"># logging.debug(&quot;Found taskname &quot; + taskname)</span>
                    <span class="k">return</span> <span class="n">AtmosphericModel</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">AtmosphericModel</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning Atmospheric Model not found&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetAtmosphericModelFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetSiteFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetSiteFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetSiteFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Site:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">Site</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="c1"># logging.debug(&quot;Found taskname &quot; + taskname)</span>
                    <span class="k">return</span> <span class="n">Site</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">Site</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning Site not found&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetSiteFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetLatLongFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetLatLongFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetLatLongFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;(Lat:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">Lat</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">Lat</span> <span class="o">=</span> <span class="n">Lat</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">Lat</span> <span class="o">=</span> <span class="n">Lat</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">Lat</span> <span class="o">=</span> <span class="n">Lat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">Long</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                    <span class="n">Long</span> <span class="o">=</span> <span class="n">Long</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">Long</span> <span class="o">=</span> <span class="n">Long</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">Long</span> <span class="o">=</span> <span class="n">Long</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">return</span> <span class="n">Lat</span><span class="p">,</span> <span class="n">Long</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">Lat</span>
                <span class="n">Long</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning Latitude or Longitude not found&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetLatLongFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetDateFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetDateFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetDateFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Date:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">Date</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="c1"># logging.debug(&quot;Found taskname &quot; + taskname)</span>
                    <span class="k">return</span> <span class="n">Date</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">Date</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning Date not found&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetDateFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetInjectionAltitudeFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetInjectionAltitudeFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetInjectionAltitudeFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Injection altitude&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
                        <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="p">)</span>  <span class="c1"># since somtimes we can have the (D) of default and sometimes not i make sure this is whatever is after the :</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">injalt</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">unit</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;km&quot;</span><span class="p">:</span>
                        <span class="n">injalt</span> <span class="o">=</span> <span class="n">injalt</span> <span class="o">*</span> <span class="mf">1000.0</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;cm&quot;</span><span class="p">:</span>
                        <span class="n">injalt</span> <span class="o">=</span> <span class="n">injalt</span> <span class="o">/</span> <span class="mf">100.0</span>
                    <span class="k">return</span> <span class="n">injalt</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">injalt</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning Injection Altitude not found&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetInjectionAltitudeFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetEnergyFractionInNeutrinosFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetEnergyFractionInNeutrinosFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetEnergyFractionInNeutrinosFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="n">founditonce</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Neutrinos:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">founditonce</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                        <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;Neutrinos:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                        <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                        <span class="n">stripedline</span> <span class="o">=</span> <span class="n">stripedline</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                        <span class="n">energyf</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="k">return</span> <span class="n">energyf</span>
                    <span class="n">founditonce</span> <span class="o">=</span> <span class="n">founditonce</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">energyf</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning NeutrinoEnergyFraction not found&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetEnergyFractionInNeutrinosFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="get_antenna_t0">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.get_antenna_t0">[docs]</a>
<span class="k">def</span> <span class="nf">get_antenna_t0</span><span class="p">(</span><span class="n">xant</span><span class="p">,</span> <span class="n">yant</span><span class="p">,</span> <span class="n">hant</span><span class="p">,</span> <span class="n">azimuthdeg</span><span class="p">,</span> <span class="n">zenithdeg</span><span class="p">):</span>
    <span class="c1"># this code is copied from zhaires fieldinit</span>
    <span class="c1"># returns the t0 of the antenna in ns</span>
    <span class="c1"># x,y,hant is antenna position in zhaires reference frame, hant is the altitude above ground (its making flat earth asumptions for now)</span>
    <span class="c1"># azimuth and zenith are in ZHAireS,degrees</span>
    <span class="n">cspeed</span> <span class="o">=</span> <span class="mf">299792458.0</span>
    <span class="c1"># get incoming azimut in radians</span>
    <span class="n">phidirrad</span> <span class="o">=</span> <span class="n">azimuthdeg</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span>
    <span class="c1"># set phidirrad in the rangle [0,2pi]</span>
    <span class="k">if</span> <span class="n">phidirrad</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="n">phidirrad</span> <span class="o">=</span> <span class="n">phidirrad</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

    <span class="n">zenithrad</span> <span class="o">=</span> <span class="n">zenithdeg</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span>
    <span class="c1"># Auxiliary variables</span>
    <span class="n">coszenith</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">zenithrad</span><span class="p">)</span>
    <span class="n">sinzenith</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">zenithrad</span><span class="p">)</span>
    <span class="n">tanzenith</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">zenithrad</span><span class="p">)</span>

    <span class="c1"># distance to the axis</span>
    <span class="n">Rant</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xant</span> <span class="o">*</span> <span class="n">xant</span> <span class="o">+</span> <span class="n">yant</span> <span class="o">*</span> <span class="n">yant</span><span class="p">)</span>
    <span class="c1"># phi</span>
    <span class="n">phiantrad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">yant</span><span class="p">,</span> <span class="n">xant</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">phiantrad</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">phiantrad</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">+</span> <span class="n">phiantrad</span>

    <span class="c1"># Adjusting time window</span>
    <span class="c1"># phi of antenna</span>
    <span class="c1"># projection of r of antenna on shower phi direction</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">phidirrad</span> <span class="o">-</span> <span class="n">phiantrad</span><span class="p">)</span>

    <span class="n">rproj</span> <span class="o">=</span> <span class="n">Rant</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>

    <span class="n">dtna</span> <span class="o">=</span> <span class="p">(</span><span class="n">hant</span> <span class="o">/</span> <span class="n">coszenith</span> <span class="o">+</span> <span class="p">(</span><span class="n">rproj</span> <span class="o">-</span> <span class="n">hant</span> <span class="o">*</span> <span class="n">tanzenith</span><span class="p">)</span> <span class="o">*</span> <span class="n">sinzenith</span><span class="p">)</span> <span class="o">/</span> <span class="n">cspeed</span>

    <span class="k">return</span> <span class="n">dtna</span> <span class="o">*</span> <span class="mf">1.0e9</span></div>



<div class="viewcode-block" id="GetAntennaInfoFromSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetAntennaInfoFromSry">[docs]</a>
<span class="k">def</span> <span class="nf">GetAntennaInfoFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>

    <span class="n">AntennaID</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">AntennaX</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">AntennaY</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">AntennaZ</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">AntennaT</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">Read</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">ReadLegacy</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">AntennaN</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Read</span><span class="p">:</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
                        <span class="n">AntennaID</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">AntennaX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="n">AntennaY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                        <span class="n">AntennaZ</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">stripedline</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;**********&quot;</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;trying to recover an antenna t0&quot;</span><span class="p">)</span>
                            <span class="n">azimuthdeg</span> <span class="o">=</span> <span class="n">GetAzimuthAngleFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;AIRES&quot;</span><span class="p">)</span>
                            <span class="n">zenithdeg</span> <span class="o">=</span> <span class="n">GetZenithAngleFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;AIRES&quot;</span><span class="p">)</span>
                            <span class="n">xant</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                            <span class="n">yant</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                            <span class="n">zant</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
                            <span class="n">ground</span> <span class="o">=</span> <span class="n">GetGroundAltitudeFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">)</span>
                            <span class="n">hant</span> <span class="o">=</span> <span class="n">zant</span> <span class="o">-</span> <span class="n">ground</span>
                            <span class="nb">print</span><span class="p">(</span><span class="n">xant</span><span class="p">,</span> <span class="n">yant</span><span class="p">,</span> <span class="n">zant</span><span class="p">,</span> <span class="n">hant</span><span class="p">,</span> <span class="n">azimuthdeg</span><span class="p">,</span> <span class="n">zenithdeg</span><span class="p">)</span>
                            <span class="n">stripedline</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span>
                                <span class="n">get_antenna_t0</span><span class="p">(</span><span class="n">xant</span><span class="p">,</span> <span class="n">yant</span><span class="p">,</span> <span class="n">hant</span><span class="p">,</span> <span class="n">azimuthdeg</span><span class="p">,</span> <span class="n">zenithdeg</span><span class="p">)</span>
                            <span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>

                        <span class="n">AntennaT</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">Read</span> <span class="o">=</span> <span class="kc">False</span>

                        <span class="c1"># now, i need to make the AntennaID Unique, so that i can store them in the file</span>
                        <span class="n">dups</span> <span class="o">=</span> <span class="p">{}</span>

                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">AntennaID</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">val</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dups</span><span class="p">:</span>
                                <span class="c1"># Store index of first occurrence and occurrence value</span>
                                <span class="n">dups</span><span class="p">[</span><span class="n">val</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="c1"># Special case for first occurrence</span>
                                <span class="k">if</span> <span class="n">dups</span><span class="p">[</span><span class="n">val</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                                    <span class="n">AntennaID</span><span class="p">[</span><span class="n">dups</span><span class="p">[</span><span class="n">val</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">dups</span><span class="p">[</span><span class="n">val</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

                                <span class="c1"># Increment occurrence value, index value doesn&#39;t matter anymore</span>
                                <span class="n">dups</span><span class="p">[</span><span class="n">val</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

                                <span class="c1"># Use stored occurrence value</span>
                                <span class="n">AntennaID</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">dups</span><span class="p">[</span><span class="n">val</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

                        <span class="k">return</span> <span class="n">AntennaID</span><span class="p">,</span> <span class="n">AntennaX</span><span class="p">,</span> <span class="n">AntennaY</span><span class="p">,</span> <span class="n">AntennaZ</span><span class="p">,</span> <span class="n">AntennaT</span>

                <span class="k">if</span> <span class="n">ReadLegacy</span><span class="p">:</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                        <span class="n">AntennaX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">AntennaY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="n">AntennaZ</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                        <span class="n">AntennaT</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
                        <span class="n">AntennaID</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Antenna&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">AntennaN</span><span class="p">))</span>
                        <span class="n">AntennaN</span> <span class="o">=</span> <span class="n">AntennaN</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ReadLegacy</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">return</span> <span class="n">AntennaID</span><span class="p">,</span> <span class="n">AntennaX</span><span class="p">,</span> <span class="n">AntennaY</span><span class="p">,</span> <span class="n">AntennaZ</span><span class="p">,</span> <span class="n">AntennaT</span>

                <span class="k">elif</span> <span class="s2">&quot;Antenna|      Label      |&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">Read</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="s2">&quot;Antenna|   X [m]&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">ReadLegacy</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetAntennaInfoFromSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetLongitudinalTable">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetLongitudinalTable">[docs]</a>
<span class="k">def</span> <span class="nf">GetLongitudinalTable</span><span class="p">(</span><span class="n">Path</span><span class="p">,</span> <span class="n">TableNumber</span><span class="p">,</span> <span class="n">Slant</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Precision</span><span class="o">=</span><span class="s2">&quot;Double&quot;</span><span class="p">):</span>
    <span class="c1"># todo: check against a list of valid tables</span>
    <span class="n">deletefile</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">sryfile</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">Path</span> <span class="o">+</span> <span class="s2">&quot;/*.sry&quot;</span><span class="p">)</span>
    <span class="n">idffile</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">Path</span> <span class="o">+</span> <span class="s2">&quot;/*.idf&quot;</span><span class="p">)</span>
    <span class="n">inpfile</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">Path</span> <span class="o">+</span> <span class="s2">&quot;/*.inp&quot;</span><span class="p">)</span>
    <span class="n">tablefile</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">Path</span> <span class="o">+</span> <span class="s2">&quot;/*.t&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">TableNumber</span><span class="p">))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tablefile</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">idffile</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="s2">&quot;The requested table was not found, and the idf file is not present. Cannot get the table&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idffile</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">tablefile</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;could not find the table, trying to get it from the idf&quot;</span><span class="p">)</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">idffile</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">taskname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">base</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Path</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">taskname</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">60</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">taskname</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">60</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Slant</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">AiresPath</span>
                    <span class="o">+</span> <span class="s2">&quot;/AiresExport -O a &quot;</span>
                    <span class="o">+</span> <span class="n">Path</span>
                    <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
                    <span class="o">+</span> <span class="n">taskname</span>
                    <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">TableNumber</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">Slant</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="n">AiresPath</span> <span class="o">+</span> <span class="s2">&quot;/AiresExport &quot;</span> <span class="o">+</span> <span class="n">Path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">taskname</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">TableNumber</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;unrecognized Slant value, please state either True/False&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;abut to run &quot;</span> <span class="o">+</span> <span class="n">cmd</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="n">tablefile</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">Path</span> <span class="o">+</span> <span class="s2">&quot;/*.t&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">TableNumber</span><span class="p">))</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tablefile</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Table exported successfully&quot;</span><span class="p">)</span>
                <span class="n">deletefile</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">taskname</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">60</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;idf path+name is too long, need to copy the idf here&quot;</span><span class="p">)</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;cp &quot;</span> <span class="o">+</span> <span class="n">idffile</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; .&quot;</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">Slant</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="n">AiresPath</span> <span class="o">+</span> <span class="s2">&quot;/AiresExport -O a &quot;</span> <span class="o">+</span> <span class="n">taskname</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">TableNumber</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">Slant</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="n">AiresPath</span> <span class="o">+</span> <span class="s2">&quot;/AiresExport &quot;</span> <span class="o">+</span> <span class="n">taskname</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">TableNumber</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;unrecognized Slant value, please state either True/False&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="n">tablefile</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.t&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">TableNumber</span><span class="p">))</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">tablefile</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tablefile</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># this means we are not wo</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Table exported successfully&quot;</span><span class="p">)</span>
                <span class="n">deletefile</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;rm &quot;</span> <span class="o">+</span> <span class="n">taskname</span> <span class="o">+</span> <span class="s2">&quot;.idf&quot;</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;rm &quot;</span> <span class="o">+</span> <span class="n">taskname</span> <span class="o">+</span> <span class="s2">&quot;.lgf&quot;</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;task name is to long, AIRES does not support that!&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tablefile</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;reading file&quot;</span><span class="p">)</span>

        <span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">loadtxt</span>

        <span class="k">if</span> <span class="n">Precision</span> <span class="o">==</span> <span class="s2">&quot;Double&quot;</span><span class="p">:</span>
            <span class="n">numpyarray</span> <span class="o">=</span> <span class="n">loadtxt</span><span class="p">(</span><span class="n">tablefile</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;f8&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">Precision</span> <span class="o">==</span> <span class="s2">&quot;Simple&quot;</span><span class="p">:</span>
            <span class="n">numpyarray</span> <span class="o">=</span> <span class="n">loadtxt</span><span class="p">(</span><span class="n">tablefile</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;f4&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;unrecognized precison, please state either Double or Simple&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">if</span> <span class="n">deletefile</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;rm &quot;</span> <span class="o">+</span> <span class="n">tablefile</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Table deleted successfully&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">numpyarray</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;The requested table was not found and could not be regenerated. Sorry&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetLateralTable">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetLateralTable">[docs]</a>
<span class="k">def</span> <span class="nf">GetLateralTable</span><span class="p">(</span><span class="n">Path</span><span class="p">,</span> <span class="n">TableNumber</span><span class="p">,</span> <span class="n">Density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Precision</span><span class="o">=</span><span class="s2">&quot;Double&quot;</span><span class="p">):</span>
    <span class="c1"># todo: check against a list of valid tables</span>
    <span class="n">deletefile</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">sryfile</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">Path</span> <span class="o">+</span> <span class="s2">&quot;/*.sry&quot;</span><span class="p">)</span>
    <span class="n">idffile</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">Path</span> <span class="o">+</span> <span class="s2">&quot;/*.idf&quot;</span><span class="p">)</span>
    <span class="n">inpfile</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">Path</span> <span class="o">+</span> <span class="s2">&quot;/*.inp&quot;</span><span class="p">)</span>
    <span class="n">tablefile</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">Path</span> <span class="o">+</span> <span class="s2">&quot;/*.t&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">TableNumber</span><span class="p">))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tablefile</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">idffile</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="s2">&quot;LDF.The requested table was not found, and the idf file is not present. Cannot get the table&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idffile</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">tablefile</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;LDF.could not find the table, trying to guess it from the idf&quot;</span><span class="p">)</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">idffile</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">taskname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">base</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Path</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">taskname</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">60</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">taskname</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">60</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">Density</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">AiresPath</span>
                    <span class="o">+</span> <span class="s2">&quot;/AiresExport -O dX &quot;</span>
                    <span class="o">+</span> <span class="n">Path</span>
                    <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
                    <span class="o">+</span> <span class="n">taskname</span>
                    <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">TableNumber</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">Density</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">AiresPath</span>
                    <span class="o">+</span> <span class="s2">&quot;/AiresExport -O X &quot;</span>
                    <span class="o">+</span> <span class="n">Path</span>
                    <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
                    <span class="o">+</span> <span class="n">taskname</span>
                    <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">TableNumber</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;LDF.unrecognized Density value, please state either True/False&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="n">tablefile</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">Path</span> <span class="o">+</span> <span class="s2">&quot;/*.t&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">TableNumber</span><span class="p">))</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tablefile</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;LDF.Table exported successfully&quot;</span><span class="p">)</span>
                <span class="n">deletefile</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">taskname</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">60</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;LDF. idf path+name is too long, need to copy the idf here&quot;</span><span class="p">)</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;cp &quot;</span> <span class="o">+</span> <span class="n">idffile</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; .&quot;</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">Density</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="n">AiresPath</span> <span class="o">+</span> <span class="s2">&quot;/AiresExport -O dX &quot;</span> <span class="o">+</span> <span class="n">taskname</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">TableNumber</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">Density</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="n">AiresPath</span> <span class="o">+</span> <span class="s2">&quot;/AiresExport -O X &quot;</span> <span class="o">+</span> <span class="n">taskname</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">TableNumber</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;LFD.unrecognized Density value, please state either True/False&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="n">tablefile</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.t&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">TableNumber</span><span class="p">))</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tablefile</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;LDF.Table exported successfully&quot;</span><span class="p">)</span>
                <span class="n">deletefile</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;rm &quot;</span> <span class="o">+</span> <span class="n">taskname</span> <span class="o">+</span> <span class="s2">&quot;.idf&quot;</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;rm &quot;</span> <span class="o">+</span> <span class="n">taskname</span> <span class="o">+</span> <span class="s2">&quot;.lgf&quot;</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;LDF.task name is to long, AIRES does not support that!&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tablefile</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;LDF.reading file&quot;</span><span class="p">)</span>

        <span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">loadtxt</span>

        <span class="k">if</span> <span class="n">Precision</span> <span class="o">==</span> <span class="s2">&quot;Double&quot;</span><span class="p">:</span>
            <span class="n">numpyarray</span> <span class="o">=</span> <span class="n">loadtxt</span><span class="p">(</span><span class="n">tablefile</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;f8&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">Precision</span> <span class="o">==</span> <span class="s2">&quot;Simple&quot;</span><span class="p">:</span>
            <span class="n">numpyarray</span> <span class="o">=</span> <span class="n">loadtxt</span><span class="p">(</span><span class="n">tablefile</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;f4&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;LDF.unrecognized precison, please state either Double or Simple&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">if</span> <span class="n">deletefile</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;rm &quot;</span> <span class="o">+</span> <span class="n">tablefile</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;LDF.Table deleted successfully&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">numpyarray</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;LDF.The requested table was not found and could not be regenerated. Sorry&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<span class="c1"># this gets the effective refraction index from poitn R0 to xant,yant,zant (default to the core position), all in meters, but kr in 1/km</span>
<span class="c1"># ns is the REFRACIVITY AR SEA LEVEL, kr is the scale height in km.</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># NOTE: Use the GetZHSEffectiveactionIndex below to get exactly the same results than in zhaires</span>
<span class="c1"># ns= refractivity at sea levele</span>
<span class="c1"># kr= scale height</span>


<div class="viewcode-block" id="GetEffectiveRefractionIndex">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetEffectiveRefractionIndex">[docs]</a>
<span class="k">def</span> <span class="nf">GetEffectiveRefractionIndex</span><span class="p">(</span>
    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">z0</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="mi">325</span><span class="p">,</span> <span class="n">kr</span><span class="o">=-</span><span class="mf">0.128</span><span class="p">,</span> <span class="n">zant</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xant</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">yant</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mi">20000</span>
<span class="p">):</span>  <span class="c1"># NOTE THAT THE ORDER OF ANTENNA POSITIONS IS ZANT,XANT,YANT (historic compatibility reasons)</span>
    <span class="n">rearth</span> <span class="o">=</span> <span class="mf">6370949.0</span>
    <span class="n">R02</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">*</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">y0</span> <span class="o">*</span> <span class="n">y0</span>  <span class="c1"># notar que se usa R02, se puede ahorrar el producto y la raiz cuadrada</span>
    <span class="n">h0</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">z0</span> <span class="o">+</span> <span class="n">rearth</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">z0</span> <span class="o">+</span> <span class="n">rearth</span><span class="p">)</span> <span class="o">+</span> <span class="n">R02</span><span class="p">)</span> <span class="o">-</span> <span class="n">rearth</span>
    <span class="p">)</span> <span class="o">/</span> <span class="mf">1.0e3</span>  <span class="c1"># altitude of emission, in km</span>

    <span class="n">rh0</span> <span class="o">=</span> <span class="n">ns</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">kr</span> <span class="o">*</span> <span class="n">h0</span><span class="p">)</span>  <span class="c1"># refractivity at emission</span>
    <span class="n">n_h0</span> <span class="o">=</span> <span class="mf">1.0e0</span> <span class="o">+</span> <span class="mf">1.0e-6</span> <span class="o">*</span> <span class="n">rh0</span>  <span class="c1"># n at emission</span>
    <span class="c1">#        print(&quot;n_h0&quot;,n_h0,ns,kr,x0,y0,z0,h0,rh0)</span>

    <span class="n">hd</span> <span class="o">=</span> <span class="p">(</span><span class="n">zant</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.0e3</span>  <span class="c1"># detector altitude</span>

    <span class="c1">#       Vector from detector to average point on track. Making the integral in this way better guaranties the continuity</span>
    <span class="c1">#       since the choping of the path will be always the same as you go farther away. If you start at your starting point, for a given geometry,</span>
    <span class="c1">#       the choping points change with each starting position.</span>

    <span class="n">ux</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">xant</span>
    <span class="n">uy</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">yant</span>  <span class="c1"># the antenna position, considered to be at the core</span>
    <span class="n">uz</span> <span class="o">=</span> <span class="n">z0</span> <span class="o">-</span> <span class="n">zant</span>

    <span class="n">Rd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ux</span> <span class="o">*</span> <span class="n">ux</span> <span class="o">+</span> <span class="n">uy</span> <span class="o">*</span> <span class="n">uy</span><span class="p">)</span>
    <span class="n">kx</span> <span class="o">=</span> <span class="n">ux</span> <span class="o">/</span> <span class="n">Rd</span>
    <span class="n">ky</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">uy</span> <span class="o">/</span> <span class="n">Rd</span>
    <span class="p">)</span>  <span class="c1">#!k is a vector from the antenna to the track, that when multiplied by Rd will end in the track and sumed to antenna position will be equal to the track positon</span>
    <span class="n">kz</span> <span class="o">=</span> <span class="n">uz</span> <span class="o">/</span> <span class="n">Rd</span>

    <span class="c1">#       integral starts at ground</span>
    <span class="n">nint</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="nb">sum</span> <span class="o">=</span> <span class="mf">0.0e0</span>

    <span class="n">currpx</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">+</span> <span class="n">xant</span>
    <span class="n">currpy</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">+</span> <span class="n">yant</span>  <span class="c1">#!current point (1st antenna position)</span>
    <span class="n">currpz</span> <span class="o">=</span> <span class="n">zant</span>
    <span class="n">currh</span> <span class="o">=</span> <span class="n">hd</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">Rd</span><span class="p">)</span>

    <span class="k">while</span> <span class="n">Rd</span> <span class="o">&gt;</span> <span class="n">stepsize</span><span class="p">:</span>  <span class="c1"># if distance projected on the xy plane is more than 10km</span>
        <span class="n">nint</span> <span class="o">=</span> <span class="n">nint</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">nextpx</span> <span class="o">=</span> <span class="n">currpx</span> <span class="o">+</span> <span class="n">kx</span> <span class="o">*</span> <span class="n">stepsize</span>
        <span class="n">nextpy</span> <span class="o">=</span> <span class="n">currpy</span> <span class="o">+</span> <span class="n">ky</span> <span class="o">*</span> <span class="n">stepsize</span>  <span class="c1"># this is the &quot;next&quot; point</span>
        <span class="n">nextpz</span> <span class="o">=</span> <span class="n">currpz</span> <span class="o">+</span> <span class="n">kz</span> <span class="o">*</span> <span class="n">stepsize</span>

        <span class="n">nextR2</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">nextpx</span> <span class="o">*</span> <span class="n">nextpx</span> <span class="o">+</span> <span class="n">nextpy</span> <span class="o">*</span> <span class="n">nextpy</span>
        <span class="p">)</span>  <span class="c1">#!se usa el cuadrado, se puede ahorrar la raiz cuadrada</span>
        <span class="n">nexth</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">nextpz</span> <span class="o">+</span> <span class="n">rearth</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">nextpz</span> <span class="o">+</span> <span class="n">rearth</span><span class="p">)</span> <span class="o">+</span> <span class="n">nextR2</span><span class="p">)</span> <span class="o">-</span> <span class="n">rearth</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.0e3</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">nexth</span> <span class="o">-</span> <span class="n">currh</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0e-10</span>
        <span class="p">):</span>  <span class="c1"># check that we are not going at constant height, if so, the refraction index is constant</span>
            <span class="nb">sum</span> <span class="o">=</span> <span class="nb">sum</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">kr</span> <span class="o">*</span> <span class="n">nexth</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">kr</span> <span class="o">*</span> <span class="n">currh</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">kr</span> <span class="o">*</span> <span class="p">(</span><span class="n">nexth</span> <span class="o">-</span> <span class="n">currh</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">sum</span> <span class="o">=</span> <span class="nb">sum</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">kr</span> <span class="o">*</span> <span class="n">currh</span><span class="p">)</span>

        <span class="n">currpx</span> <span class="o">=</span> <span class="n">nextpx</span>
        <span class="n">currpy</span> <span class="o">=</span> <span class="n">nextpy</span>
        <span class="n">currpz</span> <span class="o">=</span> <span class="n">nextpz</span>  <span class="c1"># Set new &quot;current&quot; point</span>
        <span class="n">currh</span> <span class="o">=</span> <span class="n">nexth</span>

        <span class="n">Rd</span> <span class="o">=</span> <span class="n">Rd</span> <span class="o">-</span> <span class="n">stepsize</span>  <span class="c1"># reduce the remaining lenght</span>
    <span class="c1"># enddo</span>

    <span class="c1"># when we arrive here, we know that we are left with the last part of the integral, the one closer to the track (and maybe the only one)</span>

    <span class="n">nexth</span> <span class="o">=</span> <span class="n">h0</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">nexth</span> <span class="o">-</span> <span class="n">currh</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0e-10</span>
    <span class="p">):</span>  <span class="c1"># check that we are not going at constant height, if so, the refraction index is constant</span>
        <span class="nb">sum</span> <span class="o">=</span> <span class="nb">sum</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">kr</span> <span class="o">*</span> <span class="n">nexth</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">kr</span> <span class="o">*</span> <span class="n">currh</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">kr</span> <span class="o">*</span> <span class="p">(</span><span class="n">nexth</span> <span class="o">-</span> <span class="n">currh</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">sum</span> <span class="o">=</span> <span class="nb">sum</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">kr</span> <span class="o">*</span> <span class="n">currh</span><span class="p">)</span>

    <span class="n">nint</span> <span class="o">=</span> <span class="n">nint</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">avn</span> <span class="o">=</span> <span class="n">ns</span> <span class="o">*</span> <span class="nb">sum</span> <span class="o">/</span> <span class="n">nint</span>
    <span class="n">n_eff</span> <span class="o">=</span> <span class="mf">1.0e0</span> <span class="o">+</span> <span class="mf">1.0e-6</span> <span class="o">*</span> <span class="n">avn</span>  <span class="c1"># average (effective) n</span>
    <span class="k">return</span> <span class="n">n_eff</span></div>



<span class="c1"># This is exactly what is computed in ZHAires</span>
<div class="viewcode-block" id="GetZHSEffectiveRefractionIndex">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetZHSEffectiveRefractionIndex">[docs]</a>
<span class="k">def</span> <span class="nf">GetZHSEffectiveRefractionIndex</span><span class="p">(</span>
    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">z0</span><span class="p">,</span> <span class="n">xant</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">yant</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">zant</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="mi">325</span><span class="p">,</span> <span class="n">kr</span><span class="o">=-</span><span class="mf">0.1218</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mi">20000</span>
<span class="p">):</span>
    <span class="c1">#      rearth=6371007.0 #new aires</span>
    <span class="n">rearth</span> <span class="o">=</span> <span class="mf">6370949.0</span>  <span class="c1"># 19.4.0</span>
    <span class="c1">#     Variable n integral calculation ///////////////////</span>
    <span class="n">R02</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">x0</span> <span class="o">*</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">y0</span> <span class="o">*</span> <span class="n">y0</span>
    <span class="p">)</span>  <span class="c1">#!notar que se usa R02, se puede ahorrar el producto y la raiz cuadrada (entro con injz-zXmax -&gt; injz-z0=zXmax</span>
    <span class="n">h0</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">z0</span> <span class="o">+</span> <span class="n">rearth</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">z0</span> <span class="o">+</span> <span class="n">rearth</span><span class="p">)</span> <span class="o">+</span> <span class="n">R02</span><span class="p">)</span> <span class="o">-</span> <span class="n">rearth</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e3</span>  <span class="c1">#!altitude of emission</span>

    <span class="n">rh0</span> <span class="o">=</span> <span class="n">ns</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">kr</span> <span class="o">*</span> <span class="n">h0</span><span class="p">)</span>  <span class="c1">#!refractivity at emission (this</span>
    <span class="n">n_h0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">1e-6</span> <span class="o">*</span> <span class="n">rh0</span>  <span class="c1">#!n at emission</span>
    <span class="c1">#        write(*,*) &quot;n_h0&quot;,n_h0,ns,kr,x0,y0,injz-z0,h0,rh0</span>
    <span class="n">modr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">R02</span><span class="p">)</span>

    <span class="c1">#      print(&quot;ZHS n_h0&quot;,n_h0,ns,kr,x0,y0,z0,h0,rh0)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="n">modr</span> <span class="o">&gt;</span> <span class="mi">1000</span>
    <span class="p">):</span>  <span class="c1">#! if inclined shower and point more than 20km from core. Using the core as reference distance is dangerous, its invalid in upgoing showers</span>

        <span class="c1">#         Vector from average point of track to observer.</span>
        <span class="n">ux</span> <span class="o">=</span> <span class="n">xant</span> <span class="o">-</span> <span class="n">x0</span>
        <span class="n">uy</span> <span class="o">=</span> <span class="n">yant</span> <span class="o">-</span> <span class="n">y0</span>
        <span class="n">uz</span> <span class="o">=</span> <span class="n">zant</span> <span class="o">-</span> <span class="n">z0</span>

        <span class="c1">#         divided in nint pieces shorter than 10km</span>
        <span class="n">nint</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">modr</span> <span class="o">/</span> <span class="n">stepsize</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">kx</span> <span class="o">=</span> <span class="n">ux</span> <span class="o">/</span> <span class="n">nint</span>
        <span class="n">ky</span> <span class="o">=</span> <span class="n">uy</span> <span class="o">/</span> <span class="n">nint</span>  <span class="c1"># k is vector from one point to the next</span>
        <span class="n">kz</span> <span class="o">=</span> <span class="n">uz</span> <span class="o">/</span> <span class="n">nint</span>
        <span class="c1">#</span>
        <span class="n">currpx</span> <span class="o">=</span> <span class="n">x0</span>
        <span class="n">currpy</span> <span class="o">=</span> <span class="n">y0</span>  <span class="c1"># current point (1st is emission point)</span>
        <span class="n">currpz</span> <span class="o">=</span> <span class="n">z0</span>
        <span class="n">currh</span> <span class="o">=</span> <span class="n">h0</span>
        <span class="c1">#</span>
        <span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">iii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nint</span><span class="p">):</span>
            <span class="n">nextpx</span> <span class="o">=</span> <span class="n">currpx</span> <span class="o">+</span> <span class="n">kx</span>
            <span class="n">nextpy</span> <span class="o">=</span> <span class="n">currpy</span> <span class="o">+</span> <span class="n">ky</span>  <span class="c1">#!this is the &quot;next&quot; point</span>
            <span class="n">nextpz</span> <span class="o">=</span> <span class="n">currpz</span> <span class="o">+</span> <span class="n">kz</span>
            <span class="n">nextR2</span> <span class="o">=</span> <span class="n">nextpx</span> <span class="o">*</span> <span class="n">nextpx</span> <span class="o">+</span> <span class="n">nextpy</span> <span class="o">*</span> <span class="n">nextpy</span>
            <span class="n">nexth</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">nextpz</span> <span class="o">+</span> <span class="n">rearth</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">nextpz</span> <span class="o">+</span> <span class="n">rearth</span><span class="p">)</span> <span class="o">+</span> <span class="n">nextR2</span><span class="p">)</span> <span class="o">-</span> <span class="n">rearth</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e3</span>
            <span class="c1"># c</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">nexth</span> <span class="o">-</span> <span class="n">currh</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-10</span><span class="p">:</span>
                <span class="nb">sum</span> <span class="o">=</span> <span class="nb">sum</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">kr</span> <span class="o">*</span> <span class="n">nexth</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">kr</span> <span class="o">*</span> <span class="n">currh</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">kr</span> <span class="o">*</span> <span class="p">(</span><span class="n">nexth</span> <span class="o">-</span> <span class="n">currh</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">sum</span> <span class="o">=</span> <span class="nb">sum</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">kr</span> <span class="o">*</span> <span class="n">currh</span><span class="p">)</span>
            <span class="c1">#            endif</span>
            <span class="c1"># c</span>
            <span class="n">currpx</span> <span class="o">=</span> <span class="n">nextpx</span>
            <span class="n">currpy</span> <span class="o">=</span> <span class="n">nextpy</span>
            <span class="n">currpz</span> <span class="o">=</span> <span class="n">nextpz</span>  <span class="c1">#!Set new &quot;current&quot; point</span>
            <span class="n">currh</span> <span class="o">=</span> <span class="n">nexth</span>
        <span class="c1"># c</span>
        <span class="n">avn</span> <span class="o">=</span> <span class="n">ns</span> <span class="o">*</span> <span class="nb">sum</span> <span class="o">/</span> <span class="n">nint</span>
        <span class="c1">#          print*,&quot;avn:&quot;,avn</span>
        <span class="n">n_eff</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">1e-6</span> <span class="o">*</span> <span class="n">avn</span>  <span class="c1">#!average (effective) n</span>
    <span class="c1"># c</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># c         withouth integral</span>
        <span class="n">hd</span> <span class="o">=</span> <span class="n">zant</span> <span class="o">/</span> <span class="mf">1e3</span>  <span class="c1">#!detector altitude(flat earth!)</span>
        <span class="c1">#</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">hd</span> <span class="o">-</span> <span class="n">h0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-10</span><span class="p">:</span>
            <span class="n">avn</span> <span class="o">=</span> <span class="p">(</span><span class="n">ns</span> <span class="o">/</span> <span class="p">(</span><span class="n">kr</span> <span class="o">*</span> <span class="p">(</span><span class="n">hd</span> <span class="o">-</span> <span class="n">h0</span><span class="p">)))</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">kr</span> <span class="o">*</span> <span class="n">hd</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">kr</span> <span class="o">*</span> <span class="n">h0</span><span class="p">))</span>
        <span class="c1">#            print*,&quot;avn2:&quot;,avn</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">avn</span> <span class="o">=</span> <span class="n">ns</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">kr</span> <span class="o">*</span> <span class="n">h0</span><span class="p">)</span>
        <span class="c1">#           print*,&quot;avn3:&quot;,avn</span>
        <span class="c1">#            print *,&quot;Effective n: h0=hd&quot;</span>
        <span class="c1">#          endif</span>
        <span class="n">n_eff</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">1e-6</span> <span class="o">*</span> <span class="n">avn</span>  <span class="c1">#!average (effective) n</span>
    <span class="c1">#        endif</span>
    <span class="c1"># c     ///////////////////////////////////////////////////</span>
    <span class="k">return</span> <span class="n">n_eff</span></div>



<span class="c1">#      end</span>


<div class="viewcode-block" id="ReadAiresSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.ReadAiresSry">[docs]</a>
<span class="k">def</span> <span class="nf">ReadAiresSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>

    <span class="n">zen</span> <span class="o">=</span> <span class="n">GetZenithAngleFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="p">)</span>
    <span class="n">azim</span> <span class="o">=</span> <span class="n">GetAzimuthAngleFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="p">)</span>
    <span class="n">energy</span> <span class="o">=</span> <span class="n">GetEnergyFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="p">)</span>
    <span class="n">primary</span> <span class="o">=</span> <span class="n">GetPrimaryFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="p">)</span>
    <span class="n">xmax</span> <span class="o">=</span> <span class="n">GetSlantXmaxFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="p">)</span>
    <span class="n">kmxmax</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">GetKmXmaxFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="p">)</span>
    <span class="n">taskname</span> <span class="o">=</span> <span class="n">GetTaskNameFromSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">zen</span><span class="p">,</span> <span class="n">azim</span><span class="p">,</span> <span class="n">energy</span><span class="p">,</span> <span class="n">primary</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">taskname</span></div>



<div class="viewcode-block" id="ReadAiresLgf">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.ReadAiresLgf">[docs]</a>
<span class="k">def</span> <span class="nf">ReadAiresLgf</span><span class="p">(</span><span class="n">lgf_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>

    <span class="n">zen</span> <span class="o">=</span> <span class="n">GetZenithAngleFromSry</span><span class="p">(</span><span class="n">lgf_file</span><span class="p">,</span> <span class="n">outmode</span><span class="p">)</span>
    <span class="n">azim</span> <span class="o">=</span> <span class="n">GetAzimuthAngleFromSry</span><span class="p">(</span><span class="n">lgf_file</span><span class="p">,</span> <span class="n">outmode</span><span class="p">)</span>
    <span class="n">energy</span> <span class="o">=</span> <span class="n">GetEnergyFromSry</span><span class="p">(</span><span class="n">lgf_file</span><span class="p">,</span> <span class="n">outmode</span><span class="p">)</span>
    <span class="n">primary</span> <span class="o">=</span> <span class="n">GetPrimaryFromSry</span><span class="p">(</span><span class="n">lgf_file</span><span class="p">,</span> <span class="n">outmode</span><span class="p">)</span>
    <span class="n">taskname</span> <span class="o">=</span> <span class="n">GetTaskNameFromSry</span><span class="p">(</span><span class="n">lgf_file</span><span class="p">,</span> <span class="n">outmode</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">zen</span><span class="p">,</span> <span class="n">azim</span><span class="p">,</span> <span class="n">energy</span><span class="p">,</span> <span class="n">primary</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">taskname</span></div>



<div class="viewcode-block" id="GetStatusFromStatus">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetStatusFromStatus">[docs]</a>
<span class="k">def</span> <span class="nf">GetStatusFromStatus</span><span class="p">(</span><span class="n">status_file</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">status_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">status_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Aires_Msg&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">status</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="n">status</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="n">status</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="c1"># logging.debug(&quot;Found status &quot; + status)</span>
                    <span class="k">return</span> <span class="n">status</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">status</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning status not found in status file&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="s2">&quot;not found&quot;</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetStatusFromStatus:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">status_file</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="GetTmpFromDirs">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.GetTmpFromDirs">[docs]</a>
<span class="k">def</span> <span class="nf">GetTmpFromDirs</span><span class="p">(</span><span class="n">dirs_file</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dirs_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dirs_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Aires_DRandomfn&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="c1"># logging.debug(&quot;Found Tmp &quot; + tmp)</span>
                    <span class="k">return</span> <span class="n">tmp</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">tmp</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning Aires_DRandomfn not found in dirs file&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="s2">&quot;not found&quot;</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;GetTmpFromSDirs:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">dirs_file</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>



<div class="viewcode-block" id="DeprecatedReadAiresSry">
<a class="viewcode-back" href="../../src_outlib.html#src_outlib.AiresInfoFunctionsGRANDROOT.DeprecatedReadAiresSry">[docs]</a>
<span class="k">def</span> <span class="nf">DeprecatedReadAiresSry</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="n">outmode</span><span class="o">=</span><span class="s2">&quot;GRAND&quot;</span><span class="p">):</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">datafile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sry_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

    <span class="k">except</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;ReasAiresSry:file not found or invalid:&quot;</span> <span class="o">+</span> <span class="n">sry_file</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">datafile</span><span class="p">:</span>
        <span class="c1">## print(line) #debug level 2</span>

        <span class="k">if</span> <span class="s2">&quot;Primary zenith angle:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
            <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">zen</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">outmode</span> <span class="o">==</span> <span class="s2">&quot;GRAND&quot;</span><span class="p">:</span>
                <span class="n">zen</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="mi">180</span> <span class="o">-</span> <span class="n">zen</span>
                <span class="p">)</span>  <span class="c1"># conversion to GRAND convention i.e. pointing towards antenna/propagtion direction</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Found Zenith &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">zen</span><span class="p">))</span>

        <span class="k">if</span> <span class="s2">&quot;Primary azimuth angle:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
            <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">azim</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">outmode</span> <span class="o">==</span> <span class="s2">&quot;GRAND&quot;</span><span class="p">:</span>
                <span class="n">azim</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">azim</span> <span class="o">+</span> <span class="mi">180</span>
                <span class="p">)</span>  <span class="c1"># conversion to GRAND convention i.e. pointing towards antenna/propagtion direction</span>
                <span class="k">if</span> <span class="n">azim</span> <span class="o">&gt;=</span> <span class="mi">360</span><span class="p">:</span>
                    <span class="n">azim</span> <span class="o">=</span> <span class="n">azim</span> <span class="o">-</span> <span class="mi">360</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Found Azimuth &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">azim</span><span class="p">))</span>

        <span class="k">if</span> <span class="s2">&quot;Primary energy:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
            <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">energy</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">energy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">])</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">outmode</span> <span class="o">==</span> <span class="s2">&quot;GRAND&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;eV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-18</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;KeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-15</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;MeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-12</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;GeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-9</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;TeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-6</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;PeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-3</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;EeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span>

                <span class="k">if</span> <span class="n">outmode</span> <span class="o">==</span> <span class="s2">&quot;AIRES&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;eV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-9</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;KeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-6</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;MeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e-3</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;GeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;TeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e3</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;PeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e6</span>
                    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;EeV</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                        <span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">*</span> <span class="mf">1e9</span>

                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Found Energy &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">energy</span><span class="p">))</span>  <span class="c1"># debug level 1</span>

        <span class="k">if</span> <span class="s2">&quot;Primary particle:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
            <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">primarytype</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">primarytype</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
                <span class="n">primarytype</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
                <span class="n">primarytype</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">primarytype</span> <span class="o">=</span> <span class="s2">&quot;unknown&quot;</span>

            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Found Primary &quot;</span> <span class="o">+</span> <span class="n">primarytype</span><span class="p">)</span>  <span class="c1"># debug level 1</span>

        <span class="k">if</span> <span class="s2">&quot;Sl. depth of max. (g/cm2)&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
            <span class="n">stripedline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stripedline</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stripedline</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Found Xmax &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">xmax</span><span class="p">))</span>  <span class="c1"># debug level 1</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">zen</span>
    <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
        <span class="n">zen</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># If no zenith angle was included in the input file, AIRES defaults to 0</span>
        <span class="k">if</span> <span class="n">outmode</span> <span class="o">==</span> <span class="s2">&quot;GRAND&quot;</span><span class="p">:</span>
            <span class="n">zen</span> <span class="o">=</span> <span class="mi">180</span> <span class="o">-</span> <span class="mi">0</span>  <span class="c1"># that translates to 180 in GRAND</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">azim</span>
    <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
        <span class="n">azim</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># If no azimuth angle was included in the input file, AIRES defaults to 0</span>
        <span class="k">if</span> <span class="n">outmode</span> <span class="o">==</span> <span class="s2">&quot;GRAND&quot;</span><span class="p">:</span>
            <span class="n">azim</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">+</span> <span class="mi">180</span>  <span class="c1"># that translates to 180</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">energy</span>
    <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning energy not found, Aires has no default value,  cannot continue&quot;</span><span class="p">)</span>
        <span class="n">exit</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">primarytype</span>
    <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;warning primary not found, Aires has no default value, cannot continue&quot;</span><span class="p">)</span>
        <span class="n">exit</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">xmax</span>
    <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;warning xmax not found&quot;</span><span class="p">)</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">return</span> <span class="n">zen</span><span class="p">,</span> <span class="n">azim</span><span class="p">,</span> <span class="n">energy</span><span class="p">,</span> <span class="n">primarytype</span><span class="p">,</span> <span class="n">xmax</span></div>



<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="n">path</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">outmode</span> <span class="o">=</span> <span class="s2">&quot;AIRES&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ReadAiresSry</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">outmode</span><span class="p">))</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, GRAND Collaboration.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>